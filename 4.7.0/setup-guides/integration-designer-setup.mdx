---
title: Integration designer setup
description: Complete guide for setting up and configuring the Integration Designer service, including database connections, Kafka settings, and authentication
icon: arrow-progress
---

This guide explains how to set up and configure the Integration Designer service, which allows you to create and manage integrations between FlowX.AI and external systems through a visual interface.


## Prerequisites

Before deploying the Integration Designer service, ensure you have the following components:

| Component | Version | Purpose |
|-----------|---------|---------|
| Kubernetes | 1.19+ | Container orchestration platform |
| PostgreSQL | 13+ | Advancing data source storage |
| MongoDB | 4.4+ | Integration configurations and runtime data |
| Kafka | 2.8+ | Event-driven communication |
| OAuth2 Server | - | Authentication and authorization (Keycloak recommended) |

<Info>
Integration Designer requires two MongoDB databases:
- **integration-designer**: Service-specific data
- **app-runtime**: Shared runtime data used by multiple services
</Info>


## Configuration parameters

### Core settings

These settings control the basic operation of the Integration Designer service:

| Parameter | Description | Default | Required |
|-----------|-------------|---------|----------|
| `configProfile` | Spring configuration profiles to activate | `k8stemplate_v2,kafka-auth` | Yes |
| `webclient.bufferSize` | Buffer size for handling large API responses | `10485760` (10MB) | No |
| `javaOpts` | JVM options | `--add-opens java.base/jdk.internal.misc=ALL-UNNAMED -Dio.netty.tryReflectionSetAccessible=true` | No |

<Warning>
Always set `configProfile` explicitly to ensure the correct configuration is loaded. The value should be `k8stemplate_v2,kafka-auth` unless you have specific requirements.
</Warning>

### Database configuration

#### PostgreSQL settings

PostgreSQL is used for the advancing data source:

| Parameter | Description | Default | Required |
|-----------|-------------|---------|----------|
| `advancing.datasource.url` | JDBC URL | `jdbc:postgresql://postgresql:5432/advancing` | Yes |
| `advancing.datasource.username` | Database username | `flowx` | Yes |
| `advancing.datasource.password` | Database password | - | Yes |
| `advancing.datasource.driverClassName` | JDBC driver class | `org.postgresql.Driver` | Yes |

Example configuration:

```yaml
advancing:
  datasource:
    url: jdbc:postgresql://postgresql:5432/advancing
    username: flowx
    password: securePassword  # Replace with your actual password
    driverClassName: org.postgresql.Driver
```

<Tip>
For Oracle databases, use `oracle.jdbc.OracleDriver` as the driver class name.
</Tip>

#### MongoDB settings

Integration Designer requires two MongoDB databases:

| Parameter | Description | Default | Required |
|-----------|-------------|---------|----------|
| `mongodb.uri` | URI template for MongoDB connections | `mongodb://${DB_USERNAME}:${DB_PASSWORD}@mongodb-0.mongodb-headless,mongodb-1.mongodb-headless,mongodb-arbiter-0.mongodb-arbiter-headless:27017/${DB_NAME}?retryWrites=false` | Yes |
| `mongodb.auth.username` | Integration Designer database username | `integration-designer` | Yes |
| `mongodb.auth.password` | Integration Designer database password | - | Yes |
| `mongodb.runtime.auth.username` | Runtime database username | `app-runtime` | Yes |
| `mongodb.runtime.auth.password` | Runtime database password | - | Yes |
| `mongodb.storage` | Storage type (for Azure) | `mongodb` | No |

<Warning>
Integration Designer requires a working runtime MongoDB connection to function properly. The service will not start without this connection.
</Warning>

Example configuration:

```yaml
mongodb:
  auth:
    username: integration-designer
    password: securePassword1  # Replace with your actual password
  runtime:
    auth:
      username: app-runtime
      password: securePassword2  # Replace with your actual password
```

### Kafka configuration

Kafka is used for event-driven communication between services:

| Parameter | Description | Default | Required |
|-----------|-------------|---------|----------|
| `kafka.bootstrap.servers` | Kafka broker addresses | `kafka-flowx-kafka-bootstrap:9092` | Yes |
| `kafka.topic.naming.environment` | Environment identifier for topics | `dev` | Yes |
| `kafka.workflow.createTopics` | Auto-create workflow topics | `false` | No |
| `kafka.consumer.groupIdStartWorkflows` | Consumer group ID | `start-workflows-group` | No |
| `kafka.consumer.threadsStartWorkflows` | Number of consumer threads | `3` | No |
| `kafka.oauth.clientId` | OAuth client ID for Kafka | - | For secure Kafka |
| `kafka.oauth.clientSecret` | OAuth client secret for Kafka | - | For secure Kafka |
| `kafka.oauth.tokenEndpointUri` | Token endpoint for Kafka OAuth | - | For secure Kafka |

<Info>
Set `kafka.workflow.createTopics` to `true` in development environments for automatic topic creation, but keep it `false` in production to prevent unintended topic creation.
</Info>

Example configuration:

```yaml
kafka:
  bootstrap:
    servers: kafka-flowx-kafka-bootstrap:9092
  topic:
    naming:
      environment: dev
  workflow:
    createTopics: false  # Set to true for development
  # For secure Kafka with OAuth
  oauth:
    clientId: flowx-service-client
    clientSecret: serviceClientSecret
    tokenEndpointUri: https://keycloak.example.com/auth/realms/kafka-authz/protocol/openid-connect/token
```

#### Required Kafka topics

Integration Designer depends on specific Kafka topics:

| Topic | Pattern | Purpose |
|-------|---------|---------|
| Workflow Instances | `ai.flowx.dev.eventsgateway.receive.workflowinstances.v1` | Handles workflow instance messages |
| Engine Receive | `ai.flowx.dev.engine.receive.*` | Messages for engine service |
| Integration Receive | `ai.flowx.dev.integration.receive.*` | Messages for integration service |

<Warning>
The `max.message.bytes` setting for the workflow instances topic should be increased to at least 10MB to handle large payloads. See the [Troubleshooting](#troubleshooting) section for instructions.
</Warning>

### Authentication configuration

OAuth2 is used for authentication and authorization:

| Parameter | Description | Default | Required |
|-----------|-------------|---------|----------|
| `security.oauth2.baseServerUrl` | OAuth2 server base URL | - | Yes |
| `security.oauth2.realm` | Authentication realm | `flowx` | Yes |
| `security.oauth2.client.clientId` | Client ID | `flowx-platform-authorize` | Yes |
| `security.oauth2.client.clientSecret` | Client secret | - | Yes |
| `security.oauth2.serviceAccount.admin.clientId` | Admin service account ID | - | Yes |
| `security.oauth2.serviceAccount.admin.clientSecret` | Admin service account secret | - | Yes |

Example configuration:

```yaml
security:
  oauth2:
    baseServerUrl: https://keycloak.example.com/auth
    realm: flowx
    client:
      clientId: flowx-platform-authorize
      clientSecret: clientSecretValue
    serviceAccount:
      admin:
        clientId: integration-designer-admin
        clientSecret: adminSecretValue
```

### Monitoring and health checks

Spring Boot Actuator settings for monitoring and health checks:

| Parameter | Description | Default | Required |
|-----------|-------------|---------|----------|
| `management.endpoints.web.exposure.include` | Exposed endpoints | `health,info,metrics,prometheus` | No |
| `management.health.kubernetes.enabled` | Enable Kubernetes health | `true` | No |
| `management.health.livenessState.enabled` | Enable liveness state | `true` | No |
| `management.health.readinessState.enabled` | Enable readiness state | `true` | No |
| `management.metrics.export.prometheus.enabled` | Enable Prometheus metrics | `true` | No |

<Tip>
The following Actuator endpoints are particularly useful for monitoring:

- `/actuator/health` - Health status of the service and dependencies
- `/actuator/metrics` - Detailed performance metrics
- `/actuator/prometheus` - Metrics in Prometheus format
</Tip>

## Deployment example

Configuration for production environments:

```yaml
# values.yaml for production
configProfile: k8stemplate_v2,kafka-auth,prod

replicaCount: 2  # Multiple replicas for high availability

advancing:
  datasource:
    url: jdbc:postgresql://postgresql-prod:5432/advancing
    username: flowx
    password: prodPassword

mongodb:
  auth:
    username: integration-designer
    password: prodMongoPassword
  runtime:
    auth:
      username: app-runtime
      password: prodRuntimePassword

kafka:
  bootstrap:
    servers: kafka-prod-1:9092,kafka-prod-2:9092,kafka-prod-3:9092
  topic:
    naming:
      environment: prod
  workflow:
    createTopics: false  # Disable auto-creation in production

security:
  oauth2:
    baseServerUrl: https://keycloak-prod.example.com/auth
    realm: flowx
    client:
      clientId: flowx-platform-authorize
      clientSecret: prodClientSecret
    serviceAccount:
      admin:
        clientId: integration-designer-admin
        clientSecret: prodAdminSecret

logging:
  level:
    root: WARN
    app: INFO
    ai.flowx.integration: INFO

resources:
  limits:
    cpu: 2000m
    memory: 2048Mi
  requests:
    cpu: 1000m
    memory: 1024Mi
```

## Ingress configuration

If you need to expose the Integration Designer service externally, configure the ingress:

```yaml
ingress:
  enabled: true
  admin:
    enabled: true
    hostname: "{{ .Values.flowx.ingress.admin }}"
    path: /integration(/|$)(.*)
    annotations:
      nginx.ingress.kubernetes.io/rewrite-target: /$2
      nginx.ingress.kubernetes.io/cors-allow-headers: DNT,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization,platform,Flowx-Platform
```

## RBAC configuration

Integration Designer requires specific permissions to access Kubernetes resources:

```yaml
rbac:
  create: true
  rules:
    - apiGroups:
        - ""
      resources:
        - secrets
        - configmaps
        - pods
      verbs:
        - get
        - list
        - watch
```

## Troubleshooting

### MongoDB connection issues

If you experience MongoDB connection problems:

<AccordionGroup>
<Accordion title="Symptoms">
- Service fails to start
- MongoDB connection errors in logs
- "Cannot connect to MongoDB" errors
</Accordion>

<Accordion title="Solutions">
1. Check connection strings and credentials:
   ```bash
   kubectl exec -n <namespace> <pod-name> -- env | grep MONGO
   ```

2. Verify MongoDB pods are running:
   ```bash
   kubectl get pods -n <namespace> | grep mongodb
   ```

3. Test connectivity from the Integration Designer pod:
   ```bash
   kubectl exec -n <namespace> <pod-name> -- curl -v mongodb-0.mongodb-headless:27017
   ```

4. Check for network policies blocking connections
</Accordion>
</AccordionGroup>

### Kafka communication issues

If Kafka messaging is not working correctly:

<AccordionGroup>
<Accordion title="Symptoms">
- Workflows not progressing
- Messages not being sent or received
- Kafka connection errors in logs
</Accordion>

<Accordion title="Solutions">
1. Verify Kafka is accessible:
   ```bash
   kubectl exec -n <namespace> <pod-name> -- curl -v <kafka-bootstrap-server>:9092
   ```

2. Check consumer group status:
   ```bash
   kubectl exec -n <namespace> <kafka-pod> -- kafka-consumer-groups.sh \
     --bootstrap-server localhost:9092 \
     --describe --group start-workflows-group
   ```

3. Verify topic configuration for `max.message.bytes`:
   ```bash
   # Using AKHQ
   1. Access the AKHQ web interface
   2. Navigate to Topics → ai.flowx.dev.eventsgateway.receive.workflowinstances.v1
   3. Go to Configuration tab
   4. Set max.message.bytes to 10485760 (10MB)

   # Or using Kafka CLI
   kubectl exec -n <namespace> <kafka-pod> -- kafka-configs.sh \
     --bootstrap-server localhost:9092 \
     --entity-type topics \
     --entity-name ai.flowx.dev.eventsgateway.receive.workflowinstances.v1 \
     --alter --add-config max.message.bytes=10485760
   ```
</Accordion>
</AccordionGroup>

### Authentication failures

For OAuth2 authentication issues:

<AccordionGroup>
<Accordion title="Symptoms">
- 401/403 errors
- Authentication failed messages in logs
- Service unable to make authenticated requests
</Accordion>

<Accordion title="Solutions">
1. Verify OAuth2 server is accessible:
   ```bash
   kubectl exec -n <namespace> <pod-name> -- curl -v <oauth2-server-url>/auth/realms/<realm>/.well-known/openid-configuration
   ```

2. Check client credentials:
   ```bash
   kubectl exec -n <namespace> <pod-name> -- env | grep OAUTH
   ```

3. Make sure roles and permissions are properly configured in Keycloak:
   - The client should have the necessary roles
   - Service accounts should have appropriate permissions
</Accordion>
</AccordionGroup>

### Large API responses are truncated

If you encounter issues with large API responses:

<AccordionGroup>
<Accordion title="Symptoms">
- Incomplete data in API responses
- Unexpected errors when fetching large data sets
- Connection reset errors
</Accordion>

<Accordion title="Solutions">
1. Verify WebClient buffer size:
   ```bash
   kubectl exec -n <namespace> <pod-name> -- env | grep BUFFER
   ```

2. Increase the buffer size to at least 10MB:
   ```yaml
   flowx:
     webclient:
       buffersize: 10485760  # 10MB
   ```

3. Consider using pagination if available in the external API

4. For very large responses, implement streaming solutions
</Accordion>
</AccordionGroup>

## Next steps

After successfully setting up the Integration Designer service:

1. [Configure external systems and endpoints](../docs/platform-deep-dive/integrations/integration-designer#managing-integration-endpoints)
2. [Create integration workflows](../docs/platform-deep-dive/integrations/integration-designer#workflows)
3. [Set up authorization for external systems](../docs/platform-deep-dive/integrations/integration-designer#configuring-authorization)
4. [Link workflows to BPMN processes](../docs/platform-deep-dive/integrations/integration-designer#workflow-integration)

<Card title="Integration designer guide" href="../docs/platform-deep-dive/integrations/integration-designer" icon="diagram-project">
Learn how to use Integration Designer to create and manage integrations
</Card>