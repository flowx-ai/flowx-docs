---
title: FlowX Data Search setup
description: This guide will walk you through the process of setting up and optimizing the Data Search service using a Docker image.
icon: magnifying-glass
---

## Infrastructure prerequisites

Before proceeding, ensure the following components are set up:

* **Redis** - version 6.0 or higher 
* **Kafka** - version 2.8 or higher
* **Elasticsearch** - version 7.11.0 or higher

## Dependencies

* **Kafka**: Used for communication with the engine
* **Elasticsearch**: Used for indexing and searching data
* **Redis**: Used for caching search results and improving query performance

## Configuration

### Kafka Configuration

Set the following Kafka-related configurations using environment variables:

* `SPRING_KAFKA_BOOTSTRAP_SERVERS`: Address of the Kafka server
* `KAFKA_TOPIC_DATA_SEARCH_IN`: The Kafka topic for the search service requests to the engine
* `KAFKA_TOPIC_DATA_SEARCH_OUT`: Where the engine awaits for the response
* `KAFKA_CONSUMER_THREADS`: Number of Kafka consumer threads (adjust based on your search load)

### Elasticsearch configuration

Set the following Elasticsearch-related configurations using environment variables:

* `SPRING_ELASTICSEARCH_REST_URIS`: Elasticsearch endpoint URLs
* `SPRING_ELASTICSEARCH_REST_PROTOCOL`: Connection protocol (http/https)
* `SPRING_ELASTICSEARCH_REST_DISABLESSL`: SSL verification setting
* `SPRING_ELASTICSEARCH_REST_USERNAME`: Elasticsearch authentication username
* `SPRING_ELASTICSEARCH_REST_PASSWORD`: Elasticsearch authentication password
* `SPRING_ELASTICSEARCH_INDEX_SETTINGS_NAME` (default: `process_instance`): Index name pattern
* `SPRING_ELASTICSEARCH_INDEX_SETTINGS_SHARDS` (default: `1`): Number of primary shards
* `SPRING_ELASTICSEARCH_INDEX_SETTINGS_REPLICAS` (default: `1`): Number of replica shards

```yaml
spring:
  elasticsearch:
    rest:
      protocol: https
      uris: localhost:9200
      disableSsl: false
      username: ""
      password: ""
    index-settings:
      name: process_instance
      shards: 1
      replicas: 1
```

### Authorization & Access Roles Configuration

Set the following environment variables to connect to the identity management platform:

* `SECURITY_OAUTH2_BASE_SERVER_URL`
* `SECURITY_OAUTH2_CLIENT_CLIENT_ID`
* `SECURITY_OAUTH2_REALM`

### Logging Configuration

Control log levels using these environment variables:

* `LOGGING_LEVEL_ROOT`: For root spring boot microservice logs
* `LOGGING_LEVEL_APP`: For app-level logs
* `LOGGING_LEVEL_ELASTICSEARCH`: For Elasticsearch-specific logs

### Search Optimization

#### Index Settings
The Data Search service uses intelligent index patterns for efficient data retrieval. The index pattern is derived from the configuration property `spring.elasticsearch.index-settings.name`.

#### Search Features
1. **Fuzzy Matching**: Handles typographical errors and slight variations in search terms
2. **Field Boosting**: Prioritizes matches in specific fields
3. **Nested Object Queries**: Supports complex data structures
4. **Term & Phrase Matching**: Enables both exact and partial matches

Here's an example search query with optimized settings:

```json
{
  "query": {
    "bool": {
      "adjust_pure_negative": true,
      "boost": 1,
      "must": [
        {
          "nested": {
            "boost": 1.5,
            "path": "keyIdentifiers",
            "query": {
              "bool": {
                "must": [
                  {
                    "match": {
                      "keyIdentifiers.key.keyword": {
                        "query": "astonishingAttribute",
                        "boost": 2.0,
                        "fuzzy_transpositions": true,
                        "max_expansions": 50,
                        "fuzziness": "AUTO"
                      }
                    }
                  },
                  {
                    "match": {
                      "keyIdentifiers.originalValue.keyword": {
                        "query": "OriginalGangsta",
                        "boost": 1.5,
                        "fuzzy_transpositions": true,
                        "fuzziness": "AUTO"
                      }
                    }
                  }
                ]
              }
            },
            "score_mode": "avg"
          }
        },
        {
          "terms": {
            "processDefinitionName.keyword": [
              "TEST_PORCESS_NAME_0",
              "TEST_PORCESS_NAME_1"
            ],
            "boost": 1.2
          }
        }
      ]
    }
  },
  "track_scores": true
}
```

#### Performance Tips
1. Use appropriate shard count based on your data volume
2. Implement proper field mappings for optimal search performance
3. Utilize Redis caching for frequently accessed searches
4. Monitor and adjust relevance scoring as needed

<Info>
Kibana is an open-source data visualization and exploration tool designed primarily for Elasticsearch. It serves as the visualization layer for the Elastic Stack, allowing users to interact with their data stored in Elasticsearch to perform various activities such as querying, analyzing, and visualizing data.

For more information about Kibana and its capabilities, visit the [**Kibana official documentation**](https://www.elastic.co/guide/en/kibana/current/index.html). This resource provides in-depth guidance, tutorials, and documentation on how to use Kibana effectively for data visualization, analysis, and dashboard creation.

For advanced search optimization techniques, refer to the [**Elasticsearch Query DSL documentation**](https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html).
</Info>